<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4th Grade Paper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --text-color: #343a40;
            --bg-color: #f8f9fa;
            --border-color: #dee2e6;
            --header-bg: #34495e;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
            --skipped-color: #007bff; /* Blue for explicitly skipped */
            --unattempted-color: #ccc; /* Light gray for untouched */
        }

        /* --- बेसिक स्टाइल --- */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* --- हेडर, समरी और स्कोर बार --- */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap; 
            gap: 20px; 
        }

        h1 {
            color: var(--header-bg);
            font-weight: 700;
            margin: 0;
            flex-grow: 1; 
        }

        .summary-bar, .score-bar {
            display: flex;
            gap: 25px;
            background-color: #ffffff;
            padding: 12px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border-color);
        }
        
        .summary-bar span, .score-bar span {
            font-size: 1em;
            font-weight: 500;
            color: #555;
            white-space: nowrap; 
        }
        
        .summary-bar b, .score-bar b {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--primary-color);
        }

        .score-bar {
            background-color: #eaf5ff; 
            border-color: #b8d9f5;
        }

        .print-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
        .print-button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        
        /* --- टेबल कंटेनर (रिस्पॉन्सिव स्क्रॉल के लिए) --- */
        .table-container {
            overflow-x: auto;
        }

        /* --- टेबल स्टाइल --- */
        .test-table {
            width: 100%;
            border-collapse: collapse;
            background-color: #fff;
            border-radius: 12px;
            overflow: hidden; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border-color);
        }

        .test-table th, .test-table td {
            border: 1px solid var(--border-color);
            padding: 16px;
            text-align: center;
            vertical-align: middle;
        }

        .test-table th {
            background-color: var(--header-bg);
            color: white;
            font-weight: 600;
        }
        
        .test-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s ease;
        }
        
        .test-table th.sortable:hover { background-color: #4a6580; }
        
        .sort-arrow { margin-left: 5px; opacity: 0.7; }
        .test-table tr:nth-child(even) { background-color: #fdfdff; }
        .question-col { text-align: left !important; width: 45%; }
        .options-container label { display: block; margin-bottom: 8px; cursor: pointer; }

        .result-icon { font-size: 1.8em; font-weight: 700; }
        .correct { color: var(--correct-color); }
        .incorrect { color: var(--incorrect-color); }
        .skipped { color: var(--skipped-color); } /* Explicitly skipped */
        .unattempted { color: var(--unattempted-color); } /* Not touched */

        /* --- रिस्पॉन्सिव स्टाइल --- */
        @media (max-width: 1024px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        @media (max-width: 768px) {
            body { padding: 15px; }
            .test-table th, .test-table td { padding: 12px; font-size: 0.95em; }
        }

        /* --- प्रिंट मीडिया के लिए स्टाइल --- */
        @media print {
            body { background-color: #fff; margin: 0; padding: 10px; }
            .header-container, .print-button { display: none; }
            .container, .table-container { max-width: 100%; margin: 0; padding: 0; overflow: visible; }
            .test-table {
                box-shadow: none;
                border: 1px solid #ccc;
                border-radius: 12px; /* राउंडेड स्टाइल प्रिंट में भी रखने के लिए */
            }
            .test-table th, .test-table td {
                padding: 10px;
                border-color: #ccc;
                font-size: 0.9em;
            }
            .sortable .sort-arrow, .options-container input { display: none; }
            .options-container label { margin-bottom: 4px; }
            .result-icon { font-size: 1.5em; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header-container">
        <h1>4th Grade 2nd Shift (Paper Code - n)</h1>
        <div class="summary-bar">
            <span>कुल: <b id="total-count">0</b></span>
            <span>सही: <b id="correct-count" style="color: var(--correct-color);">0</b></span>
            <span>गलत: <b id="incorrect-count" style="color: var(--incorrect-color);">0</b></span>
            <span>छोड़े गए: <b id="skipped-count" style="color: var(--skipped-color);">0</b></span>
        </div>
         <div class="score-bar">
            <span>Final Questions: <b id="final-score">0.00</b></span>
        </div>
        <button class="print-button" onclick="window.print()">Print Answer Sheet</button>
    </div>

    <div class="table-container">
        <table class="test-table" id="analysisTable">
            <thead>
                <tr>
                    <th class="sortable" onclick="sortTable(0)">Master S.No. <span class="sort-arrow"></span></th>
                    <th class="sortable" onclick="sortTable(1)">My Paper<span class="sort-arrow"></span></th>
                    <th class="sortable" onclick="sortTable(2)">विषय <span class="sort-arrow"></span></th>
                    <th class="question-col sortable" onclick="sortTable(3)">प्रश्न / विकल्प <span class="sort-arrow"></span></th>
                    <th>My Ans.</th>
                    <th>Official</th>
                    <th class="sortable" onclick="sortTable(6)">परिणाम <span class="sort-arrow"></span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td> <td>7</td> <td>करंट अफेयर्स</td>
                    <td class="question-col">
                        <p>चित्रांगदा सिंह, राजस्थान की एक कलाकार, किस क्षेत्र में सर्वाधिक प्रसिद्ध हैं?</p>
                        <div class="options-container">
                            <label><input type="radio" name="q1" value="A" onchange="updateAnswer(this, 1, 'A')"> (A) अभिनेत्री</label>
                            <label><input type="radio" name="q1" value="B" onchange="updateAnswer(this, 1, 'B')"> (B) संगीतकार</label>
                            <label><input type="radio" name="q1" value="C" onchange="updateAnswer(this, 1, 'C')"> (C) मूर्तिकला</label>
                            <label><input type="radio" name="q1" value="D" onchange="updateAnswer(this, 1, 'D')"> (D) चित्रकार</label>
                            <label><input type="radio" name="q1" value="E" onchange="updateAnswer(this, 1, 'E')"> (E) प्रश्न हल नहीं किया</label>
                        </div>
                    </td>
                    <td></td> <td>A</td> <td><span class="result-icon unattempted">○</span></td>
                </tr>
                <tr>
                    <td>2</td> <td>15</td> <td>इतिहास</td>
                    <td class="question-col">
                        <p>राजस्थान की राजधानी क्या है?</p>
                         <div class="options-container">
                            <label><input type="radio" name="q2" value="A" onchange="updateAnswer(this, 2, 'A')"> (A) जोधपुर</label>
                            <label><input type="radio" name="q2" value="B" onchange="updateAnswer(this, 2, 'B')"> (B) जयपुर</label>
                            <label><input type="radio" name="q2" value="C" onchange="updateAnswer(this, 2, 'C')"> (C) उदयपुर</label>
                            <label><input type="radio" name="q2" value="D" onchange="updateAnswer(this, 2, 'D')"> (D) अजमेर</label>
                            <label><input type="radio" name="q2" value="E" onchange="updateAnswer(this, 2, 'E')"> (E) प्रश्न हल नहीं किया</label>
                        </div>
                    </td>
                    <td></td> <td>B</td> <td><span class="result-icon unattempted">○</span></td>
                </tr>
                <tr>
                    <td>3</td> <td>42</td> <td>भूगोल</td>
                    <td class="question-col">
                        <p>भारत का सबसे बड़ा मरुस्थल कौन सा है?</p>
                         <div class="options-container">
                            <label><input type="radio" name="q3" value="A" onchange="updateAnswer(this, 3, 'A')"> (A) थार रेगिस्तान</label>
                            <label><input type="radio" name="q3" value="B" onchange="updateAnswer(this, 3, 'B')"> (B) कच्छ का रण</label>
                            <label><input type="radio" name="q3" value="C" onchange="updateAnswer(this, 3, 'C')"> (C) स्पीति घाटी ठंडा रेगिस्तान</label>
                            <label><input type="radio" name="q3" value="D" onchange="updateAnswer(this, 3, 'D')"> (D) दक्कन काँटेदार झाड़ियाँ</label>
                            <label><input type="radio" name="q3" value="E" onchange="updateAnswer(this, 3, 'E')"> (E) प्रश्न हल नहीं किया</label>
                        </div>
                    </td>
                    <td></td> <td>A</td> <td><span class="result-icon unattempted">○</span></td>
                </tr>
                <tr>
                    <td>4</td> <td>23</td> <td>राजनीति</td>
                    <td class="question-col">
                        <p>भारतीय संविधान के जनक के रूप में किसे जाना जाता है?</p>
                        <div class="options-container">
                            <label><input type="radio" name="q4" value="A" onchange="updateAnswer(this, 4, 'A')"> (A) महात्मा गांधी</label>
                            <label><input type="radio" name="q4" value="B" onchange="updateAnswer(this, 4, 'B')"> (B) जवाहरलाल नेहरू</label>
                            <label><input type="radio" name="q4" value="C" onchange="updateAnswer(this, 4, 'C')"> (C) डॉ. बी. आर. अम्बेडकर</label>
                            <label><input type="radio" name="q4" value="D" onchange="updateAnswer(this, 4, 'D')"> (D) सरदार पटेल</label>
                            <label><input type="radio" name="q4" value="E" onchange="updateAnswer(this, 4, 'E')"> (E) प्रश्न हल नहीं किया</label>
                        </div>
                    </td>
                    <td></td> <td>C</td> <td><span class="result-icon unattempted">○</span></td>
                </tr>
                 <tr>
                    <td>5</td> <td>88</td> <td>कला</td>
                    <td class="question-col">
                        <p>प्रसिद्ध 'ब्लू पॉटरी' राजस्थान के किस शहर से है?</p>
                        <div class="options-container">
                            <label><input type="radio" name="q5" value="A" onchange="updateAnswer(this, 5, 'A')"> (A) उदयपुर</label>
                            <label><input type="radio" name="q5" value="B" onchange="updateAnswer(this, 5, 'B')"> (B) बीकानेर</label>
                            <label><input type="radio" name="q5" value="C" onchange="updateAnswer(this, 5, 'C')"> (C) कोटा</label>
                            <label><input type="radio" name="q5" value="D" onchange="updateAnswer(this, 5, 'D')"> (D) जयपुर</label>
                            <label><input type="radio" name="q5" value="E" onchange="updateAnswer(this, 5, 'E')"> (E) प्रश्न हल नहीं किया</label>
                        </div>
                    </td>
                    <td></td> <td>D</td> <td><span class="result-icon unattempted">○</span></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

    <script>
        function updateAnswer(radioInput, questionNumber, selectedOption) {
            const currentRow = radioInput.closest('tr');
            const myAnsCell = currentRow.cells[4];
            const officialKeyCell = currentRow.cells[5];
            const resultCell = currentRow.cells[6];
            myAnsCell.textContent = selectedOption;
            const officialAnswer = officialKeyCell.textContent;

            if (selectedOption === 'E') {
                resultCell.innerHTML = '<span class="result-icon skipped">○</span>';
            } else if (selectedOption === officialAnswer) {
                resultCell.innerHTML = '<span class="result-icon correct">✓</span>';
            } else {
                resultCell.innerHTML = '<span class="result-icon incorrect">✗</span>';
            }
            localStorage.setItem('q' + questionNumber + '_answer', selectedOption);
            updateSummaryAndScore();
        }

        function updateSummaryAndScore() {
            const rows = document.querySelectorAll("#analysisTable tbody tr");
            let correct = 0, incorrect = 0, skipped = 0;
            rows.forEach(row => {
                const resultIcon = row.cells[6].querySelector('.result-icon');
                if (resultIcon.classList.contains('correct')) correct++;
                else if (resultIcon.classList.contains('incorrect')) incorrect++;
                else if (resultIcon.classList.contains('skipped')) skipped++;
            });
            document.getElementById('total-count').textContent = rows.length;
            document.getElementById('correct-count').textContent = correct;
            document.getElementById('incorrect-count').textContent = incorrect;
            document.getElementById('skipped-count').textContent = skipped;
            const finalScore = correct - (incorrect / 3);
            document.getElementById('final-score').textContent = finalScore.toFixed(2);
        }

        function sortTable(columnIndex) {
            const table = document.getElementById("analysisTable");
            const tbody = table.tBodies[0];
            const rows = Array.from(tbody.rows);
            const headerCell = table.tHead.rows[0].cells[columnIndex];
            const currentDir = headerCell.getAttribute("data-sort-dir") || "desc";
            const newDir = currentDir === "asc" ? "desc" : "asc";
            table.querySelectorAll("th.sortable").forEach(th => {
                th.removeAttribute("data-sort-dir");
                th.querySelector(".sort-arrow").textContent = "";
            });
            headerCell.setAttribute("data-sort-dir", newDir);
            headerCell.querySelector(".sort-arrow").textContent = newDir === "asc" ? " ▲" : " ▼";
            const resultPriority = { '✓': 1, '✗': 2, '○': 3 };
            rows.sort((rowA, rowB) => {
                let valA = rowA.cells[columnIndex].textContent.trim();
                let valB = rowB.cells[columnIndex].textContent.trim();
                if (columnIndex === 6) {
                    valA = resultPriority[valA] || 3; valB = resultPriority[valB] || 3;
                }
                if (!isNaN(valA) && !isNaN(valB) && valA.trim() !== "" && valB.trim() !== "") {
                    valA = parseFloat(valA); valB = parseFloat(valB);
                }
                if (valA < valB) return newDir === "asc" ? -1 : 1;
                if (valA > valB) return newDir === "asc" ? 1 : -1;
                return 0;
            });
            rows.forEach(row => tbody.appendChild(row));
        }
        
        function loadSavedAnswers() {
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                const questionName = radio.name;
                const savedAnswer = localStorage.getItem(questionName + '_answer');
                if (savedAnswer && radio.value === savedAnswer) {
                    radio.checked = true;
                    const currentRow = radio.closest('tr');
                    if (currentRow) {
                        const myAnsCell = currentRow.cells[4];
                        const officialKeyCell = currentRow.cells[5];
                        const resultCell = currentRow.cells[6];
                        myAnsCell.textContent = savedAnswer;
                        const officialAnswer = officialKeyCell.textContent.trim();
                        if (savedAnswer === 'E') resultCell.innerHTML = '<span class="result-icon skipped">○</span>';
                        else if (savedAnswer === officialAnswer) resultCell.innerHTML = '<span class="result-icon correct">✓</span>';
                        else resultCell.innerHTML = '<span class="result-icon incorrect">✗</span>';
                    }
                }
            });
            updateSummaryAndScore();
        }

        document.addEventListener('DOMContentLoaded', loadSavedAnswers);
    </script>

</body>
</html>